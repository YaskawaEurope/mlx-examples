company: Yaskawa Europe GmbH
author: Rioual
comment: IO data for the McePosTable function
changelog:
  - version: 0.2.0
    date: 2024-02-08
    author: Rioual
    changed:
      - Variable `bStep` renamed `bExecute`
    removed:
      - Variable `bHigherLevelControlled`
      - Variable `bCmdEnable`
      - Variable `bCmdRun`
  - version: 0.1.1
    date: 2024-02-06
    author: Rioual
    removed:
      - variables of features not implemented yet
  - version: 0.1.0
    date: 2022-02-11
    author: Rioual
    added:
      - first version
#   changed:
#   fixed:
#   deprecated:
#   removed:
#   security:
var:
  - name: nRobotNumber
  - name: bSystemReady
  - name: bExecute
    description: |
      *Used as input*

      Launch the trajectory on a rising edge if `nPosTableMode = 0` or `nPosTableMode = 1`.

      Run the next motion (or actionID) if `nPosTableMode = 2`.

      Also used by `ACTIONID_WAIT_STEPBUTTON`.
    type: BOOL
    comment: "input: trigger (e.g. pushbutton) for transition step. Only available if `bHigherLevelControlled` is false"
  - name: bStop
    description: |
      Stop the current trajectory.

      Robot motion is not stopped instantaneously.
      Buffered motions will continue until the buffer is empty.
      Run `MLxStop` command to stop the current motion and reset the motion buffer.
    type: BOOL
    comment: "input: stop PosTable"
  - name: bReset
    description: |
      Stop the current trajectory and set `nIndex` to `0`.

      Robot motion is not stopped instantaneously.
      Buffered motions will continue until the buffer is empty.
      Run `MLxStop` command to stop the current motion and reset the motion buffer.
    type: BOOL
    comment: "input: stop PosTable and reset `nIndex` to `0`"
  - name: bRecalcQA
    description: |
      *Used as input*

      Used as a trigger recalculate the **Queueing amount** `QA`.

      Useful to remove an `actionID` while the PosTable is running.
    type: BOOL
    comment: "input: recalculate QA (queueing amount)"
  - name: nPosTableMode
    description: |
      *Used as input*

      Used as an input to select the PosTable operation mode.
    type: SINT
    default_value: "0"
    comment: "input: PosTable operation mode [0=with blending, 1=not blending, 2=single motion (wait for step after each motion)]"
    legend:
      "0" : "With blending"
      "1" : "Not blending"
      "2" : "Single motion (wait for step after each motion)"
  - name: nNrOfCycles
    description: |
      *Used as input*

      Used as an input to set how many time the current PosTable should be run.
    type: INT
    default_value: "1"
    comment: "input: for setting the number of cycles for the PosTable [0=repeat forever, 1=single cycle, >1=n cycles]"
    legend:
      "0" : "Repeat forever"
      "1" : "Single cycle"
      ">1" : "`n` cycles"
  - name: fSpeedManipulation
    description: |
      *Used as input*

      Used as an input to set a speed factor to the following motions.
    type: REAL
    default_value: "10.0"
    comment: "input: for manipulating the programmed speed of each entry [0=no manipulation, >0=% of programmed speed]"
    legend:
      "0" : "no speed factor applied"
      ">0" : "factor in `%` of programmed speed"
  - name: bCustomActionDone
    description: |
      *Used as input*

      Used as an input to notify that a custom `ActionID` is completed.
    type: BOOL
    comment: "input: custom action at standstill done"
  - name: bActionStart
    description: |
      *Used as output*

      State that the robot is in standstill and an `ActionID` is in process.
    type: BOOL
    comment: "output: start action at standstill"
  - name: nActionID
    description: |
      *Used as output*

      Current *ActionID* number, used for custom actions.
    type: INT
    comment: "output: action with standstill; 0=none, >0=other"
    legend:
      "0" : "no current action"
      ">0" : "current *ActionID* number"
  - name: nPercentComplete
    description: |
      *Used as output*

      Percentage of the current motion that is completed.
    type: SINT
    comment: "output: Percentage of motion that is completed (for active motion command)"
  - name: nStateTime
    description: |
      *Used as output*

      Elapsed time in current state.

      Value is in `ms`.
    type: DINT
    comment: "output: elapsed time in current state [ms]"
  - name: bWaitForExecute
    description: |
      *Used as output*

      System is waiting for a user `bExecute` trigger.
    type: BOOL
    comment: "output: Wait for user bExecute trigger"
  - name: bDone
    description: |
      *Used as output*

      *PosTable* has finished executing the asked number of cycles.

      Either increase [`nNrOfCycles`](#nnrofcycles) or start a new sequence with [`bCmdStart`](#bcmdstart).
    comment: PosTable has finished executing the asked number of cycles
  - name: bIdle
    description: |
      *Used as output*

      State machine in *idle* state.

      Enable [`bSystemReady`](#bsystemready) and [`bCmdStart`](#bcmdstart) to run *PosTable*.
    comment: PosTable in idle
  - name: bError
  - name: bBusy
  - name: nErrorCode
  - name: nSmPosTable
    description: |
      State machine 1: Run the trajectory of PosTable
    type: UINT
    default_value: "0"
    comment: "in/out: state machine 1: PosTable"
    legend:
      "00": idle, not ready for start
      "01": ready for start
      "11": move to pos n / queue pos n+1, n+2 / user frame and tool change included
      "12": move to pos n+1 / queue pos n+2, n / user frame and tool change included
      "13": move to pos n+2 / queue pos n, n+1 / user frame and tool change included
      "20": waiting before performing action at standstill
      "21": perform action at standstill
      "30": cycle completed
      "40": abort cycle
      "50": waiting at end of cycle
      "99": state machine error
  - name: nIndex
    description: |
      PosTable index for current motion.

      Useful to track the progression of the trajectory.
    type: INT
    comment: "in/out: PosTable index for current motion"
  - name: nLoadIndex
    description: |
      PosTable index of the last loaded motion.
      
      Useful to track the number of points loaded in advance.
    type: INT
    comment: "in/out: PosTable index for loading next motion(s)"
  - name: nCycleNr
    description: |
      Number of cycles ran by *PosTable*.
    type: INT
    comment: "in/out: number of cycles ran by PosTable"